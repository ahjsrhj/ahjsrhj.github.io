<!DOCTYPE html><html lang=zh-CN><head><meta name=generator content="Hexo 3.9.0"><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><title>Android透明状态栏实践 · Hexer</title><meta name=description content="Android透明状态栏实践 - Hexer"><meta name=viewport content="width=device-width, initial-scale=1"><link rel=icon href=https://i.loli.net/2018/12/05/5c07807cb76f9.png><link rel=stylesheet href=/css/apollo.css><link rel=search type=application/opensearchdescription+xml href=https://imrhj.cn/atom.xml title=Hexer></head><body><div class=wrap><header><a href="/" class=logo-link><img src=https://i.loli.net/2018/12/05/5c07807cb76f9.png alt=logo></a><ul class="nav nav-list"><li class=nav-list-item><a href="/" target=_self class=nav-list-link>BLOG</a></li><li class=nav-list-item><a href="/archives/" target=_self class=nav-list-link>ARCHIVE</a></li><li class=nav-list-item><a href="/about/" target=_self class=nav-list-link>ABOUT</a></li><li class=nav-list-item><a href=https://github.com/ahjsrhj target=_blank class=nav-list-link>GITHUB</a></li><li class=nav-list-item><a href="/friend/" target=_self class=nav-list-link>FRIEND</a></li></ul><script src=/js/canvas-nest-check.js></script></header><main class=container><div class=post><article class=post-block><h1 class=post-title>Android透明状态栏实践</h1><div class=post-info>2016年5月3日</div><div class=post-content><p>关于透明状态栏<del>(沉浸式状态栏)</del>大家应该都有用过，从Android 4.4开始新加入的<code>windowTranslucentStatus</code>属性可以将<code>StatusBar</code>设置为透明，即在<code>v19</code>的<code>style.xml</code>中添加</p><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>item</span> <span class=attr>name</span>=<span class=string>"android:windowTranslucentStatus"</span>&gt;</span>true<span class=tag>&lt;/<span class=name>item</span>&gt;</span></span><br></pre></td></tr></table></figure><p>之后布局的内容会顶到顶栏。但是这种情况下<code>ActionBar</code>也会被顶栏遮挡，如图:</p><center><img src=https://i.loli.net/2019/06/14/5d035c0e5e86551230.png alt=1560501261744.png></center><p>此时有两种解决方法，一是给根布局添加<code>android:fitsSystemWindows=&quot;true&quot;</code>属性，将<code>StatusBar</code>空出来。但是。。。</p><center><img src=https://i.loli.net/2019/06/14/5d035c363ffa040545.png></center><p>咳，大概是打开的方式不对，换种方式再来。</p><hr><h1 id=0x0-开启透明><a href=#0x0-开启透明 class=headerlink title="0x0 开启透明"></a>0x0 开启透明</h1><p>新建一个<code>styles.xml(v19)</code>，添加<code>windowTranslucentStatus</code>属性，这条属性即开启状态栏透明。</p><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><span class=line><span class=meta>&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>resources</span>&gt;</span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>style</span> <span class=attr>name</span>=<span class=string>"AppTheme"</span> <span class=attr>parent</span>=<span class=string>"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span></span><br><span class=line><span class=xml>                <span class=comment>&lt;!-- Customize your theme here. --&gt;</span></span></span><br><span class=line><span class=xml>                <span class=tag>&lt;<span class=name>item</span> <span class=attr>name</span>=<span class=string>"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class=tag>&lt;/<span class=name>item</span>&gt;</span></span></span><br><span class=line><span class=xml>                <span class=tag>&lt;<span class=name>item</span> <span class=attr>name</span>=<span class=string>"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class=tag>&lt;/<span class=name>item</span>&gt;</span></span></span><br><span class=line><span class=xml>                <span class=tag>&lt;<span class=name>item</span> <span class=attr>name</span>=<span class=string>"colorAccent"</span>&gt;</span>@color/colorAccent<span class=tag>&lt;/<span class=name>item</span>&gt;</span></span></span><br><span class=line><span class=xml>                <span class=tag>&lt;<span class=name>item</span> <span class=attr>name</span>=<span class=string>"android:windowTranslucentStatus"</span>&gt;</span>true<span class=tag>&lt;/<span class=name>item</span>&gt;</span></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>style</span>&gt;</span></span><br><span class=line><span class=tag>&lt;/<span class=name>resources</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=0x1-添加一个statusView><a href=#0x1-添加一个statusView class=headerlink title="0x1 添加一个statusView"></a>0x1 添加一个statusView</h1><p>在根布局的顶部添加一个<code>View</code>,高度为<code>25dp</code></p><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>View</span></span></span><br><span class=line><span class=tag>    <span class=attr>android:id</span>=<span class=string>"@+id/status_bar"</span></span></span><br><span class=line><span class=tag>    <span class=attr>android:layout_width</span>=<span class=string>"match_parent"</span></span></span><br><span class=line><span class=tag>    <span class=attr>android:layout_height</span>=<span class=string>"25dp"</span>/&gt;</span></span><br></pre></td></tr></table></figure><h1 id=0x2-代码中判断版本><a href=#0x2-代码中判断版本 class=headerlink title="0x2 代码中判断版本"></a>0x2 代码中判断版本</h1><p>当目标版本不低于v19时，将view隐藏，防止在低版本出现重复</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><span class=line><span class=meta>@Override</span></span><br><span class=line><span class=function><span class=keyword>protected</span> <span class=keyword>void</span> <span class=title>onCreate</span><span class=params>(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class=line>	<span class=keyword>super</span>.onCreate(savedInstanceState);</span><br><span class=line>    setContentView(R.layout.activity_test);</span><br><span class=line>	View statusBar = findViewById(R.id.status_bar);</span><br><span class=line>    <span class=keyword>if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</span><br><span class=line>        statusBar.setVisibility(View.VISIBLE);</span><br><span class=line>    &#125;<span class=keyword>else</span>&#123;</span><br><span class=line>    	statusBar.setVisibility(View.GONE);</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><ul><li>Android 4.4：</li></ul><center><img src=https://i.loli.net/2019/06/14/5d035ca0b8ec439606.png></center><ul><li>Android 4.1:</li></ul><center><img src=https://i.loli.net/2019/06/14/5d035cb2e843e36613.png></center></div></article></div></main><footer><div class=paginator><a href="/2016/set-layer-type-make-view-redraw/" class=prev>PREV</a><a href="/2016/the-interview-knowledge/" class=next>NEXT</a></div><script>var comments = 'true';
if (comments === 'true') {
    (function() {
        var vl = document.createElement('script');
        vl.src = '//cdn1.lncld.net/static/js/3.0.4/av-min.js';
        vl.async = true;
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(vl);
        var vl2 = document.createElement('script');
        vl2.src = '//unpkg.com/valine/dist/Valine.min.js';
        vl2.async = true;
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(vl2);
        var commitDiv = document.createElement('div');
        commitDiv.id='comment';
        document.getElementsByTagName('footer')[0].appendChild(commitDiv);
    })();
}</script><div class=copyright><p>© 2015 - 2021 <a href=https://imrhj.cn>Hexer</a>, <a href="http://beian.miit.gov.cn/" target=_blank>皖ICP备16006159号-1</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity=sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW crossorigin=anonymous></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-109294877-1",'auto');ga('send','pageview');</script><script>var comments = 'true';
if (comments === 'true') {
    (function() {
        let _tt = 20;
        let _tc = setInterval(() => {
            try {
                new Valine({
                    el: '#comment' ,
                    notify:false, 
                    verify:false, 
                    appId: 'lMIQlAfa6UoprWfiEDOceMSz-gzGzoHsz',
                    appKey: 'KiGYzc5UupBdbac67AJA54dJ',
                    placeholder: '来都来了，说点啥不 ٩(●˙▿˙●)۶…⋆ฺ',
                    path:window.location.pathname, 
                    avatar:'identicon',
                    guest_info: ['nick','link']
                });
                clearInterval(_tc)
            } catch(e) {
                _tt--;
                if (_tt < 1) {
                    clearInterval(_tc)
                }
            }
        }, 500)
    })();
}</script></body></html>